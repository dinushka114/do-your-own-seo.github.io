---
---
<?xml version="1.0" encoding="UTF-8"?>
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9" xmlns:image="http://www.google.com/schemas/sitemap-image/1.1">
{%- for image in site.static_files -%}
    {% if image.path contains 'images/posts/large' %}
    <url>
      <loc>{{ site.url }}{{ image.path }}</loc>
    </url>
    {% endif %}
{%- endfor  -%}
{%- assign allImages = '' | split: ',' -%}
{%- assign posts = site.posts | sort:'date' | reverse -%}
{% for post in posts %}
    <url>
      <loc>{{ site.url }}{{ post.url }}</loc>
    {%- assign images = post.content | split:"<img "-%}
    {% for image in images %}
      {%- assign inner = image | split:"/>" | first -%}
      {%- assign attributes = inner | split:" " -%}
      {%- for A in attributes -%}
        {%- if A contains 'src' -%}
          {%- assign array = A | split:'src="' -%}
          {%- if array[0] == '' -%}
            {%- assign src = array[1] | split:'"' -%}
{%-comment-%} unless allImages contains src[0] {%-endcomment-%}
              {%- assign allImages = allImages | push: src[0] -%}
        <image:image>
          <image:loc>{{ site.url }}{{ src[0] }}</image:loc>
        </image:image>
{%-comment-%} endunless {%-endcomment-%}
          {%- endif -%}
        {%- endif -%}
      {%- endfor -%}
    {% endfor %}
    </url>
{% endfor %}
</urlset>
